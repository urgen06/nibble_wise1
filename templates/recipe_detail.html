{% extends 'base.html' %}
{% load static %}

{% block title %}{{ recipe.title }} - SuperCook Clone{% endblock %}
{% block content %}
<section class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <div class="bg-white rounded-xl shadow-soft overflow-hidden relative">

        <!-- Slideshow container -->
        <div class="relative w-full h-64 overflow-hidden">
            {% for photo in recipe.photos %}
            <img src="{{ photo.url }}"
                 class="slide absolute top-0 left-0 w-full h-full object-cover transition-opacity duration-500"
                 style="opacity:0;">
            {% endfor %}

            <!-- Navigation buttons (only one set!) -->
            <button id="prev" class="absolute top-1/2 left-2 transform -translate-y-1/2 bg-white p-2 rounded-full shadow">‹</button>
            <button id="next" class="absolute top-1/2 right-2 transform -translate-y-1/2 bg-white p-2 rounded-full shadow">›</button>
        </div>

        <div class="p-6 space-y-4">
            <h1 class="text-2xl font-bold">{{ recipe.title }}</h1>
            <div class="flex items-center gap-4 text-sm text-gray-600">
                <span>{{ recipe.time }} mins</span>
                <span>{{ recipe.difficulty }}</span>
            </div>

            <div>
                <h3 class="font-semibold mb-2">Ingredients</h3>
                <ul class="list-disc list-inside text-gray-700">
                    {% for i in recipe.ingredients.all %}
                    <li>{{ i.name }}</li>
                    {% endfor %}
                </ul>
            </div>

            <div>
                <h3 class="font-semibold mb-2">Steps</h3>
                <ol class="list-decimal list-inside text-gray-700 space-y-1">
                    {% for s in recipe.steps %}
                    <li>{{ s }}</li>
                    {% endfor %}
                </ol>
            </div>
        </div>
    </div>
</section>

<script>
const slides = document.querySelectorAll('.slide');
let current = 0;

function showSlide(index) {
    slides.forEach((s, i) => s.style.opacity = i === index ? 1 : 0);
}

document.getElementById('prev').addEventListener('click', () => {
    current = (current - 1 + slides.length) % slides.length;
    showSlide(current);
});

document.getElementById('next').addEventListener('click', () => {
    current = (current + 1) % slides.length;
    showSlide(current);
});

showSlide(current);
</script>
{% endblock %}
